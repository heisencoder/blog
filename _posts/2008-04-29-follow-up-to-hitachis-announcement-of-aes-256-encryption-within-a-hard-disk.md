---
title: "Follow-up to Hitachi's Announcement of AES-256 Encryption Within a Hard Disk"
date: 2008-04-29 23:16:00 +0000
categories:
  - IEEE SISWG
  - Storage
  - Cryptography
blogger_orig_url: /2008/04/follow-up-to-hitachis-announcement-of.html
---

As many readers noticed, last week <a href="http://hardware.slashdot.org/article.pl?sid=08/04/22/1521221">Slashdot covered</a> a <a href="http://www.fujitsu.com/global/news/pr/archives/month/2008/20080421-01.html">announcement</a> that Fujitsu is the first to offer 256-bit <a href="http://en.wikipedia.org/wiki/Advanced_Encryption_Standard">AES encryption</a> in their <a href="http://www.fujitsu.com/global/services/computing/storage/hdd/mhdd/mhz2080cj-mhz2320cj.html">MHZ2 CJ Series</a> 320 GB 2.5" hard drives.  As chair of the <a href="https://siswg.net/">IEEE P1619 Security in Storage Working Group</a>, I felt an obligation to get more details on exactly what 'AES-256' encryption means. So I clicked on the handy box to submit questions, and got the following responses from Fujitsu:<blockquote>1. What is the mode of operation for the AES block cipher (e.g., ECB, CBC, CTR, etc)?<br />===> We don't disclose this.<br /><br />2. How are the 256-bit AES keys managed?<br />===> We don't disclose this.<br /><br />3. Is Fujitsu considering NIST FIPS 140-2 certification for this disk drive (like Seagate is doing)?<br />===> under consideration.  <br /></blockquote>I had similar questions about Seagate's Full Disk Encryption (FDE) hard drive, and couldn't get any answers there, either.  According to <a href="http://csrc.nist.gov/groups/STM/cavp/documents/aes/aesval.html">AES Certificate #587</a>, Seagate is using Electronic Code Book (ECB) for their FDE.  Unfortunately, ECB is a very insecure mode-of-operation, one that I hope NIST eventually withdraws.  To visually see what I mean, take a look at the <a href="http://en.wikipedia.org/wiki/Block_cipher_modes_of_operation#Electronic_codebook_.28ECB.29">ECB encryption of Tux the penguin</a>.  The latest rumors I've heard is that Seagate is moving to cipher-block-chaining (CBC) encryption (a much more secure mode-of-operation) for subsequent encrypting hard disks.  Fujitsu will likely take a similar course, although there is expected to be some flexibility in the algorithms.<div><br /></div><div>In contrast, tape drive vendors have been much more open about the details of their tape encryption. According to the <a href="http://www.lto-technology.com/About/faq.php">LTO-Technology page</a>, LTO uses the AES-GCM mode as specified in IEEE P1619.1 (soon to be published as IEEE Std 1619-2007).  <a href="http://ca.sun.com/en/events/presentations/2006/encryption/crypto-customer-seminar-tape.pdf">Sun's T10000 uses AES-CCM</a>, both as specified in P1619.1 and in NIST SP 800-38C.  IBM's TS1120 also uses AES-GCM.</div><div><br /></div><div>So why aren't hard disk vendors disclosing the technical details about their encryption implementation?</div><div><br /></div><div>Here are my thoughts:</div><div><ol><li>Hard disk vendors don't think that the mode of encryption is too important because it is difficult to get direct access to the encrypted data (this would require bypassing the firmware or putting the hard disk on a spin stand)</li><li>Hard disk vendors are afraid that weaknesses will be found in their encryption mode, whether real or perceived</li><li>There are no good standards to use for hard disk encryption</li></ol></div><div>While it is true that most users don't understand enough about encryption to even know what a mode-of-operation is, I believe that these details will become increasingly important as buyers become better educated and demand open details about the encryption.  Otherwise there is no way to know whether you've been sold snake oil that doesn't actually provide measurable benefits (for example, weak ECB encryption of the entire hard disk using the otherwise strong AES block cipher).</div><div><br /></div><div>Concerning standards, this is an example of how the late arrival of IEEE 1619 has caused confusion in the storage encryption industry.  When IEEE 1619 start about 6 years ago, the goal was to create a strong encryption standard suitable for data storage devices.  First came the wide-block EME mode.  This mode fell when Antoine Joux found a vulnerability that sent Shai Halevi and Phil Rogaway back to the drawing board.  Next was the LRW mode.  This fell when Niels Ferguson of Microsoft noted in Crypto 2006 that you can leak the tweak key if encrypted with itself (Microsoft has no control over where the keys are).  About this same time, the Trusted Computing Group wanted to endorse LRW (this was dropped).  About two years ago during the LRW unrest, <a href="http://grouper.ieee.org/groups/1619/email/msg00610.html">Mart Somermaa pointed the group to the XEX mode</a> as proposed by Phil Rogaway.  The P1619 group added ciphertext-stealing to this mode and called it XTS-AES.  </div><div><br /></div><div>The XTS-AES algorithm was approved last December by IEEE as part of IEEE 1619-2007, and is nearly published.  After it is published, IEEE will submit XTS to NIST for consideration as an Approved Mode of Operation for FIPS 140-2.  If NIST accepts XTS, then this will become an excellent mode for hard disk vendors to consider.</div>

---

## Comments

<div class="archived-comments">

<div class="comment">
  <div class="comment-header">
    <strong>Grayhound</strong> <span class="comment-date">April 25, 2009 at 03:54 PM</span>
  </div>
  <div class="comment-body">
    I´m using discryptor to encrypt my data. It is userfriendly and really fast.
  </div>
</div>
</div>
